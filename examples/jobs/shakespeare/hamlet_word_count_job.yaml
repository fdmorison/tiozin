kind: Job
name: hamlet_word_count_job
team: tiozin
cost_center: tio_patinhas
owner: tiozin@tiozin.com
description: |
  Pre-processes Shakespeare source texts and produces
  word count metrics as a refined data product.

org: tiozin
region: latam
domain: literature
product: shakespeare
model: hamlet
layer: refined

runner:
  kind: SparkRunner

inputs:
  - kind: SparkFileInput
    name: load_poems
    path: ./output/lake-{{domain}}-raw/{{product}}/{{model}}/date={{today}}

transforms:
  - kind: SparkWordCountTransform
    name: word_count

outputs:
  - kind: SparkFileOutput
    name: save_word_counts
    path: ./output/lake-{{domain}}-{{layer}}/{{product}}/{{model}}/date={{today}}
